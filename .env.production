# APIWeaver Production Environment Configuration
# Copy this file to .env.prod for production deployment

# ===========================================
# Application Configuration (Production)
# ===========================================
VERSION=1.0.0
COMMIT_SHA=prod
BUILD_TIME=2024-01-01T00:00:00Z

# Server Configuration (Production Optimized)
PORT=8080
HOST=0.0.0.0
LOG_LEVEL=warn
NODE_ENV=production

# ===========================================
# MongoDB Configuration (Production)
# ===========================================
MONGODB_ROOT_USERNAME=admin
MONGODB_ROOT_PASSWORD=CHANGE_THIS_IN_PRODUCTION_MONGODB_PASSWORD
MONGODB_DATABASE=apiweaver
MONGODB_PORT=27017
MONGODB_TIMEOUT=10s
MONGODB_CACHE_SIZE=1.0
MONGODB_MEMORY_LIMIT=2G

# Data Persistence Paths (Production)
MONGODB_DATA_PATH=/var/lib/apiweaver/mongodb
APIWEAVER_DATA_PATH=/var/lib/apiweaver/data
APIWEAVER_LOGS_PATH=/var/log/apiweaver
MONGODB_LOGS_PATH=/var/log/mongodb
BACKUP_PATH=/var/backups/apiweaver

# ===========================================
# Security Configuration (Production)
# ===========================================
JWT_SECRET=CHANGE_THIS_TO_A_STRONG_RANDOM_SECRET_AT_LEAST_32_CHARACTERS_LONG_FOR_PRODUCTION
API_KEY_HEADER=X-API-Key
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://api.yourdomain.com

# ===========================================
# Feature Flags (Production)
# ===========================================
ENABLE_API_KEYS=true
ENABLE_RATE_LIMITING=true
ENABLE_METRICS=true
ENABLE_PPROF=false
ENABLE_DEBUG_ENDPOINTS=false

# ===========================================
# Performance Configuration (Production)
# ===========================================
MAX_UPLOAD_SIZE=50MB
REQUEST_TIMEOUT=60s
WORKER_POOL_SIZE=20
APIWEAVER_REPLICAS=3
NGINX_REPLICAS=2

# Rate Limiting (Production - Stricter)
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=5

# Go Runtime Optimization
GOMAXPROCS=4
GOGC=100
GOMEMLIMIT=1GiB

# MongoDB Connection Pool (Production)
MONGODB_MAX_POOL_SIZE=200
MONGODB_MIN_POOL_SIZE=10
MONGODB_MAX_IDLE_TIME=30s

# ===========================================
# Nginx Configuration (Production)
# ===========================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=2048

# ===========================================
# SSL Configuration (Production)
# ===========================================
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_CA_PATH=/etc/nginx/ssl/ca.pem

# ===========================================
# Monitoring & Observability (Production)
# ===========================================
PROMETHEUS_METRICS_PORT=9090
GRAFANA_PORT=3000
JAEGER_ENDPOINT=http://jaeger:14268/api/traces

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=5

# ===========================================
# Backup Configuration (Production)
# ===========================================
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=gzip
BACKUP_ENCRYPTION=true

# Cloud Storage (Optional)
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=us-east-1
# BACKUP_S3_BUCKET=apiweaver-backups-prod

# ===========================================
# Docker Swarm Configuration (Production)
# ===========================================
COMPOSE_PROJECT_NAME=apiweaver-prod
DOCKER_STACK_NAME=apiweaver

# ===========================================
# Security Headers & Hardening
# ===========================================
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# ===========================================
# Audit & Compliance
# ===========================================
AUDIT_LOGGING_ENABLED=true
COMPLIANCE_MODE=SOC2
DATA_RETENTION_DAYS=2555  # 7 years

# ===========================================
# Network Configuration
# ===========================================
NETWORK_SUBNET=172.20.0.0/16
NETWORK_GATEWAY=172.20.0.1

# ===========================================
# Resource Limits (Production)
# ===========================================
# APIWeaver Service
APIWEAVER_MEMORY_LIMIT=1G
APIWEAVER_CPU_LIMIT=2.0
APIWEAVER_MEMORY_RESERVATION=512M
APIWEAVER_CPU_RESERVATION=1.0

# MongoDB Service  
MONGODB_MEMORY_LIMIT=4G
MONGODB_CPU_LIMIT=2.0
MONGODB_MEMORY_RESERVATION=2G
MONGODB_CPU_RESERVATION=1.0

# Nginx Service
NGINX_MEMORY_LIMIT=256M
NGINX_CPU_LIMIT=1.0
NGINX_MEMORY_RESERVATION=128M
NGINX_CPU_RESERVATION=0.5